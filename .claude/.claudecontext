# Claude Context for DIIID_IMAS Project

## ⚠️ CRITICAL: Data Privacy and Testing Policy ⚠️

**NEVER EXECUTE ANY CODE IN THIS PROJECT**

This project works with restricted DIII-D fusion data that is NOT publicly accessible.

### Absolute Prohibitions:
1. **NEVER run Python code** - No python -c, no scripts, no imports, no execution whatsoever
2. **NEVER run pytest** - Tests access restricted MDS+ data
3. **NEVER execute any command** that might access MDS+ servers or data
4. **NEVER run background processes** that could fetch data

### Why:
- Running ANY code would expose restricted fusion research data
- Data access requires proper authorization that AI assistants don't have
- All data remains on user's local machine with proper access controls

### What you CAN do:
- Read and analyze code
- Write new code (but never execute it)
- Review and suggest improvements
- Help debug by reading error messages/logs provided by user
- Modify source and test files
- Use static analysis tools (grep, find, etc.)

### What you MUST NOT do:
- Execute Python code in any form (python, python -c, import statements, etc.)
- Run pytest or any test runners
- Run scripts that import `omas.mdsvalue`
- Use Bash to run Python commands

**If you catch yourself about to execute code**: STOP. The user will run it and provide you the results.

## Quick Reference

### OMAS Fetching Pattern
```python
machine_to_omas(ods, 'd3d', shot, 'ids_name.*')  # Fetch all fields for an IDS
```

### OMAS Uncertainty Access
- `ods['path']['data']` - nominal values
- `ods['path']['data_error_upper']` - uncertainties
(Ignore `unumpy.uarray()` in OMAS source - it auto-converts)

### Development Philosophy
- No backwards compatibility needed - this is a new application
- Let tests fail when behavior changes - explicit is better than implicit
- No fallback defaults - clear errors are better than silent fallbacks

## OMAS Reference Files for Debugging

When stuck, read `imas_composer/ids/<ids_name>_omas_reference.py` to see the OMAS implementation.

**Key patterns:**
- Static data (known paths) → OMAS `query` dict → use **DIRECT** stage
- Dynamic data (depends on fetch) → OMAS sequences → use **DERIVED** stage
- Unit conversions must match OMAS exactly

## Architecture Quick Links

For detailed guidance, see:
- **DEVELOPMENT_PRINCIPLES.md** - Three-stage system, YAML config, requirement isolation, test structure
- **EQUILIBRIUM_IMPLEMENTATION.md** - Equilibrium-specific patterns (COCOS, ragged arrays, etc.)
